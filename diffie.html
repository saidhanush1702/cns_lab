<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>Diffie-Hellman Key Exchange</title>

    <script type="text/javascript">
        function test1() {
            // Read values from input boxes
            var p = parseInt(document.getElementById("p").value, 10);
            var g = parseInt(document.getElementById("g").value, 10);
            var x = parseInt(document.getElementById("x").value, 10); // Alice private
            var y = parseInt(document.getElementById("y").value, 10); // Bob private

            document.write("p value is: " + p + "<br>");
            document.write("g value is: " + g + "<br>");
            document.write("x => private key of Alice is: " + x + "<br>");
            document.write("y => private key of Bob is: " + y + "<br><br>");

            // Public keys
            var a = (Math.pow(g, x)) % p; // Alice public key
            var b = (Math.pow(g, y)) % p; // Bob public key

            // Generated keys
            var k1 = (Math.pow(b, x)) % p; // Alice's computed key
            var k2 = (Math.pow(a, y)) % p; // Bob's computed key

            // Shared secret
            var s = (Math.pow(g, (x * y))) % p;

            document.write("Public key of Alice is: " + a + "<br>");
            document.write("Public key of Bob is: " + b + "<br>");
            document.write("Key generated by Alice is: " + k1 + "<br>");
            document.write("Key generated by Bob is: " + k2 + "<br>");
            document.write("Shared secret is: " + s + "<br><br>");

            if ((k1 === s) && (k1 === k2)) {
                document.write("Success: shared secrets match!");
            } else {
                document.write("Error: shared secrets do not match");
            }
        }
    </script>
</head>

<body>
    <h2>Diffie-Hellman Key Exchange</h2>

    p (prime num): <input type="text" id="p"><br><br>
    g (primitive): <input type="text" id="g"><br><br>
    x (A private): <input type="text" id="x"><br><br>
    y (B private): <input type="text" id="y"><br><br>

    <button onclick="test1()">Submit</button>
</body>
</html>
